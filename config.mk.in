# HaskellDB configuration file. configure will produce config.mk from this file
# @configure_input@

PACKAGE_VERSION = @PACKAGE_VERSION@

GHC = @GHC@
GHCI = @GHCI@
GHC_PKG = @GHC_PKG@
GHCFLAGS = @GHCFLAGS@
GHC_DIR = @GHC_DIR@

HUGS = @HUGS@
RUNHUGS = @RUNHUGS@
HUGSFLAGS = @HUGSFLAGS@
HUGS_DIR = @HUGS_DIR@

HADDOCK = @HADDOCK@

SO_EXT = @SO_EXT@
WIN32=@WIN32@
AR = @AR@
LD = @LD@
INSTALL = @INSTALL@
LDFLAGS = @LDFLAGS@

#
# Which compilers to build libraries for
#

ENABLE_GHC = @ENABLE_GHC@
ENABLE_HUGS = @ENABLE_HUGS@

ifeq "$(ENABLE_GHC)" "yes"
COMPILERS += ghc
endif

ifeq "$(ENABLE_HUGS)" "yes"
COMPILERS += hugs
endif

#
# HSQL, unixODBC, MySQL, PostgreSQL stuff
#

# FIXME: this should probably be set by configure in the future
DRIVERS = hsql

WITH_HSQL_ODBC = @WITH_HSQL_ODBC@
WITH_HSQL_MYSQL = @WITH_HSQL_MYSQL@
WITH_HSQL_POSTGRESQL = @WITH_HSQL_POSTGRESQL@

ifeq "$(WITH_HSQL_ODBC)" "yes"
HSQL_DRIVERS += HSQL_ODBC
endif

ifeq "$(WITH_HSQL_MYSQL)" "yes"
HSQL_DRIVERS += HSQL_MySQL
endif

ifeq "$(WITH_HSQL_POSTGRESQL)" "yes"
HSQL_DRIVERS += HSQL_PostgreSQL
endif


#
# Include local HaskellDB dirs
#

SRC_DIR = $(TOP_DIR)/src

DRIVER_DIRS = $(addprefix $(SRC_DIR)/drivers/, $(DRIVERS))
IMPORT_DIRS = $(SRC_DIR) $(DRIVER_DIRS)

GHCFLAGS += $(addprefix -i, $(IMPORT_DIRS))
HUGSFLAGS += $(patsubst %, -P%:, $(IMPORT_DIRS))
# order is significant here
LDFLAGS := -L$(SRC_DIR) -lHShdb $(LDFLAGS)
